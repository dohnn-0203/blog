import{r as S,j as g,G,T as W}from"./index-CPS6bCJf.js";import{C as Y}from"./Card-D1asy7BF.js";var B={},w={},k={},D;function Z(){if(D)return k;D=1,Object.defineProperty(k,"__esModule",{value:!0}),k.useCanvasIdentifier=void 0;var i=S(),f=0,v="react-unity-webgl-canvas",o=function(U){var a=(0,i.useState)(0),e=a[0],n=a[1],r=(0,i.useCallback)(function(){n(function(l){return l+1})},[]);if(U!==void 0)return[U,r];var s=(0,i.useMemo)(function(){return[v,f].join("-")},[e]);return[s,r]};return k.useCanvasIdentifier=o,k}var j={},M={},T;function X(){return T||(T=1,Object.defineProperty(M,"__esModule",{value:!0}),M.isBrowserEnvironment=void 0,M.isBrowserEnvironment=typeof window<"u"&&typeof document<"u"),M}var z;function $(){if(z)return j;z=1,Object.defineProperty(j,"__esModule",{value:!0}),j.useUnityLoader=void 0;var i=S(),f=X(),v=function(o){var U=(0,i.useState)("Loading"),a=U[0],e=U[1];return(0,i.useEffect)(function(){if(f.isBrowserEnvironment!==!1){if(o===null){e("Idle");return}var n=window.document.querySelector('script[src="'.concat(o,'"]'));n===null?(n=window.document.createElement("script"),n.type="text/javascript",n.src=o,n.async=!0,n.setAttribute("data-status","loading"),window.document.body.appendChild(n),n.addEventListener("load",function(){return n?.setAttribute("data-status","loaded")}),n.addEventListener("error",function(){return n?.setAttribute("data-status","error")})):e(n.getAttribute("data-status")==="loaded"?"Loaded":"Error");var r=function(s){return e(s.type==="load"?"Loaded":"Error")};return n.addEventListener("load",r),n.addEventListener("error",r),function(){n!==null&&(n.removeEventListener("load",r),n.removeEventListener("error",r),n.remove())}}},[o]),a};return j.useUnityLoader=v,j}var F;function p(){if(F)return w;F=1;var i=w&&w.__awaiter||function(e,n,r,s){function l(t){return t instanceof r?t:new r(function(d){d(t)})}return new(r||(r=Promise))(function(t,d){function y(b){try{u(s.next(b))}catch(E){d(E)}}function _(b){try{u(s.throw(b))}catch(E){d(E)}}function u(b){b.done?t(b.value):l(b.value).then(y,_)}u((s=s.apply(e,n||[])).next())})},f=w&&w.__generator||function(e,n){var r={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},s,l,t,d=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return d.next=y(0),d.throw=y(1),d.return=y(2),typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function y(u){return function(b){return _([u,b])}}function _(u){if(s)throw new TypeError("Generator is already executing.");for(;d&&(d=0,u[0]&&(r=0)),r;)try{if(s=1,l&&(t=u[0]&2?l.return:u[0]?l.throw||((t=l.return)&&t.call(l),0):l.next)&&!(t=t.call(l,u[1])).done)return t;switch(l=0,t&&(u=[u[0]&2,t.value]),u[0]){case 0:case 1:t=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,l=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(t=r.trys,!(t=t.length>0&&t[t.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!t||u[1]>t[0]&&u[1]<t[3])){r.label=u[1];break}if(u[0]===6&&r.label<t[1]){r.label=t[1],t=u;break}if(t&&r.label<t[2]){r.label=t[2],r.ops.push(u);break}t[2]&&r.ops.pop(),r.trys.pop();continue}u=n.call(e,r)}catch(b){u=[6,b],l=0}finally{s=t=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(w,"__esModule",{value:!0}),w.Unity=void 0;var v=S(),o=Z(),U=$(),a=(0,v.forwardRef)(function(e,n){var r=(0,v.useState)(null),s=r[0],l=r[1],t=(0,v.useState)(null),d=t[0],y=t[1],_=(0,o.useCanvasIdentifier)(e.id),u=_[0],b=_[1],E=(0,U.useUnityLoader)(e.unityProvider.loaderUrl),A=(0,v.useCallback)(function(x){e.unityProvider.setLoadingProgression(x),x===1&&e.unityProvider.setIsLoaded(!0)},[e.unityProvider]);return(0,v.useEffect)(function(){var x=function(){return i(void 0,void 0,void 0,function(){var m,I,P,c,L;return f(this,function(h){switch(h.label){case 0:if(!s||d||E!=="Loaded")return[2];console.log("React Unity WebGL: Initializing Unity instance..."),e.unityProvider.setUnityInstance(null),y(null),e.unityProvider.setLoadingProgression(0),(L=(c=e.unityProvider).setIsLoaded)===null||L===void 0||L.call(c,!1),e.unityProvider.setInitialisationError(void 0),b(),m={companyName:e.unityProvider.companyName,productName:e.unityProvider.productName,productVersion:e.unityProvider.productVersion,dataUrl:e.unityProvider.dataUrl,frameworkUrl:e.unityProvider.frameworkUrl,codeUrl:e.unityProvider.codeUrl,workerUrl:e.unityProvider.workerUrl,memoryUrl:e.unityProvider.memoryUrl,symbolsUrl:e.unityProvider.symbolsUrl,streamingAssetsUrl:e.unityProvider.streamingAssetsUrl,devicePixelRatio:e.devicePixelRatio,webglContextAttributes:e.unityProvider.webglContextAttributes,cacheControl:e.unityProvider.cacheControl,autoSyncPersistentDataPath:e.unityProvider.autoSyncPersistentDataPath,matchWebGLToCanvasSize:e.matchWebGLToCanvasSize,disabledCanvasEvents:e.disabledCanvasEvents},Object.keys(m).forEach(function(N){(m[N]===null||m[N]===void 0)&&delete m[N]}),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,window.createUnityInstance(s,m,A)];case 2:return I=h.sent(),y(I),e.unityProvider.setUnityInstance(I),[3,4];case 3:return P=h.sent(),console.error("React Unity WebGL: Error initializing Unity instance:",P),e.unityProvider.setInitialisationError(P),[3,4];case 4:return[2]}})})},O=function(){return i(void 0,void 0,void 0,function(){var m,I,P;return f(this,function(c){switch(c.label){case 0:return!d||!s?[2]:(console.log("React Unity WebGL: Detaching Unity instance..."),e.unityProvider.setUnityInstance(null),y(null),e.unityProvider.setLoadingProgression(0),(P=(I=e.unityProvider).setIsLoaded)===null||P===void 0||P.call(I,!1),e.unityProvider.setInitialisationError(void 0),m=document.createElement("canvas"),m.id=s.id,m.setAttribute("react-unity-webgl-role","cleanup"),m.style.display="none",document.body.appendChild(m),d.Module.canvas=m,y(null),[4,d.Quit()]);case 1:return c.sent(),document.body.removeChild(m),[2]}})})};return x(),function(){O()}},[s,d,E,e.unityProvider]),(0,v.useImperativeHandle)(n,function(){return s}),(0,v.createElement)("canvas",{ref:l,id:u,style:e.style,className:e.className,tabIndex:e.tabIndex})});return w.Unity=a,w}var R={},C={},V;function ee(){if(V)return C;V=1;var i=C&&C.__spreadArray||function(e,n,r){if(r||arguments.length===2)for(var s=0,l=n.length,t;s<l;s++)(t||!(s in n))&&(t||(t=Array.prototype.slice.call(n,0,s)),t[s]=n[s]);return e.concat(t||Array.prototype.slice.call(n))};Object.defineProperty(C,"__esModule",{value:!0}),C.useEventSystem=void 0;var f=S(),v=X(),o=[],U=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var s=void 0;return o.forEach(function(l){s=l.apply(void 0,i([e],n,!1))}),s};v.isBrowserEnvironment===!0&&(window.dispatchReactUnityEvent=U);var a=function(){var e=(0,f.useRef)([]),n=(0,f.useCallback)(function(l,t){e.current=i(i([],e.current,!0),[{eventName:l,callback:t}],!1)},[e]),r=(0,f.useCallback)(function(l,t){e.current=e.current.filter(function(d){return d.eventName!==l&&d.callback!==t})},[e]),s=(0,f.useCallback)(function(l){for(var t=[],d=1;d<arguments.length;d++)t[d-1]=arguments[d];var y=e.current.find(function(_){return _.eventName===l});if(!(typeof y>"u"))return y.callback.apply(y,t)},[e]);return(0,f.useEffect)(function(){return o.push(s),function(){o.splice(o.indexOf(s),1)}},[s]),{addEventListener:n,removeEventListener:r}};return C.useEventSystem=a,C}var Q;function te(){if(Q)return R;Q=1,Object.defineProperty(R,"__esModule",{value:!0}),R.useUnityContext=void 0;var i=S(),f=ee(),v=function(o){var U=(0,i.useState)(null),a=U[0],e=U[1],n=(0,i.useState)(0),r=n[0],s=n[1],l=(0,i.useState)(!1),t=l[0],d=l[1],y=(0,i.useState)(),_=y[0],u=y[1],b=(0,f.useEventSystem)(),E=(0,i.useRef)({companyName:o.companyName,productName:o.productName,productVersion:o.productVersion,codeUrl:o.codeUrl,dataUrl:o.dataUrl,frameworkUrl:o.frameworkUrl,loaderUrl:o.loaderUrl,memoryUrl:o.memoryUrl,symbolsUrl:o.symbolsUrl,streamingAssetsUrl:o.streamingAssetsUrl,workerUrl:o.workerUrl,webglContextAttributes:o.webglContextAttributes,cacheControl:o.cacheControl,autoSyncPersistentDataPath:o.autoSyncPersistentDataPath,setUnityInstance:e,setLoadingProgression:s,setIsLoaded:d,setInitialisationError:u}),A=(0,i.useCallback)(function(c){return a?.SetFullscreen(c?1:0)},[a]),x=(0,i.useCallback)(function(){var c;return(c=a?.Module.canvas)===null||c===void 0?void 0:c.requestPointerLock()},[a]),O=(0,i.useCallback)(function(c,L,h){return a?.SendMessage(c,L,h)},[a]),m=(0,i.useCallback)(function(c,L){var h;return(h=a?.Module.canvas)===null||h===void 0?void 0:h.toDataURL(c,L)},[a]),I=(0,i.useCallback)(function(){var c;return(c=a?.Quit())!==null&&c!==void 0?c:Promise.reject()},[a]),P=(0,i.useCallback)(function(){var c;return(c=a?.GetMetricsInfo)===null||c===void 0?void 0:c.call(a)},[a]);return{unityProvider:E.current,loadingProgression:r,isLoaded:t,initialisationError:_,requestFullscreen:A,requestPointerLock:x,sendMessage:O,takeScreenshot:m,unload:I,getMetricsInfo:P,addEventListener:b.addEventListener,removeEventListener:b.removeEventListener,UNSAFE__unityInstance:a}};return R.useUnityContext=v,R}var q={},H;function re(){if(H)return q;H=1,Object.defineProperty(q,"__esModule",{value:!0}),q.useUnityMetricsInfo=void 0;var i=S(),f=function(v,o){var U=(0,i.useState)({}),a=U[0],e=U[1];return(0,i.useEffect)(function(){var n=setInterval(function(){var r=v();typeof r>"u"||e(r)},o.interval||1e3);return function(){clearInterval(n)}},[v,o.interval]),a};return q.useUnityMetricsInfo=f,q}var J;function ne(){return J||(J=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.useUnityMetricsInfo=i.useUnityContext=i.Unity=void 0;var f=p();Object.defineProperty(i,"Unity",{enumerable:!0,get:function(){return f.Unity}});var v=te();Object.defineProperty(i,"useUnityContext",{enumerable:!0,get:function(){return v.useUnityContext}});var o=re();Object.defineProperty(i,"useUnityMetricsInfo",{enumerable:!0,get:function(){return o.useUnityMetricsInfo}})})(B)),B}var K=ne();const ue=()=>{const{unityProvider:i}=K.useUnityContext({loaderUrl:"/blog/assets/webgls/build/Build/build.loader.js",dataUrl:"/blog/assets/webgls/build/Build/build.data",frameworkUrl:"/blog/assets/webgls/build/Build/build.framework.js",codeUrl:"/blog/assets/webgls/build/Build/build.wasm"});return g.jsxs(G,{children:[g.jsxs(G,{p:2,children:[g.jsx(W,{variant:"h6",fontWeight:700,mb:.5,children:"Unity WebGL Test"}),g.jsx(W,{variant:"overline",fontWeight:700,children:"- WebGL 테스트를 위한 화면 (수정중)"})]}),g.jsx(Y,{children:g.jsx(G,{children:g.jsx("div",{style:{width:"100%",height:"70vh"},children:g.jsx(K.Unity,{unityProvider:i,style:{width:"100%",height:"100%"}})})})})]})};export{ue as default};
